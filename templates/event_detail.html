{% extends "base.html" %}
{% set title = event.title ~ " - EventHub" %}

{% block content %}
<section class="section">
  <div class="container">
    <div class="event-layout">
      <div class="event-main">
        <h1 class="event-title">{{ event.title }}</h1>

        <div class="event-meta muted">
          <div>ğŸ—“ {{ event.start.strftime("%B %d, %Y â€¢ %I:%M %p") }} - {{ event.end.strftime("%I:%M %p") }}</div>
          <div>ğŸ“ {{ event.venue }}, {{ event.city }}</div>
          <div>ğŸ· {{ event.category }}</div>
        </div>

        <div class="event-desc">
          <h3>Event Description</h3>
          <p>{{ event.description }}</p>
        </div>

        <div class="panel">
          <h3>Event Location</h3>
          <img class="wide-img" src="{{ event.banner_url }}" alt="Location placeholder">
          <p class="muted small">Exact location details will be provided upon ticket purchase.</p>
        </div>

        <div class="panel">
          <h3>Frequently Asked Questions</h3>

          <details class="faq">
            <summary>Is there an age restriction for attendees?</summary>
            <p class="muted">Example answer placeholder.</p>
          </details>
          <details class="faq">
            <summary>Can I get a refund if I can't attend?</summary>
            <p class="muted">Example answer placeholder.</p>
          </details>
        </div>
      </div>

      <aside class="buy-card">
        <div class="card card-tight">
          <div class="buy-top">
            <div class="muted small">Tickets from</div>
            <div class="buy-price">${{ "%.2f"|format(event.price_usd) }}</div>
          </div>

          <form action="{{ url_for('buy_ticket', event_id=event.id) }}" method="post">
            <label class="label">Quantity</label>
            <input class="qty" type="number" min="1" max="8" name="qty" value="1">
            <div class="muted small">{{ event.available_tickets }} tickets available</div>

            <button class="btn btn-primary btn-full" type="submit">Buy Ticket</button>
            <div class="muted small center">ğŸ”’ Secure checkout</div>

            {% if buy_error %}
              <div class="alert alert-error">{{ buy_error }}</div>
            {% endif %}
            {% if buy_success %}
              <div class="alert alert-ok">{{ buy_success }}</div>
            {% endif %}
          </form>
        </div>
      </aside>
    </div>

    <div class="section">
      <h2 class="section-title">Similar Events</h2>
      <div class="grid cards-5">
        {% for e in similar %}
          <article class="card small-card">
            <img class="card-img" src="{{ e.banner_url }}" alt="Event banner">
            <div class="card-body">
              <h3 class="card-title small">{{ e.title }}</h3>
              <div class="card-meta small">
                <div>{{ e.start.strftime("%b %d, %Y") }}</div>
                <div>{{ e.city }}</div>
              </div>
              <div class="card-row">
                <span class="price">${{ "%.2f"|format(e.price_usd) }}</span>
                <a class="btn btn-ghost" href="{{ url_for('event_detail', event_id=e.id) }}">View</a>
              </div>
            </div>
          </article>
        {% endfor %}
      </div>
    </div>

  </div>
</section>
{% endblock %}
